<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Managers Bulletin</title>

  <style>
    body { font-family: Arial, sans-serif; margin: 20px; background:#fafafa; }
    .wrap { max-width: 1100px; margin: 0 auto; }

    /* ===== TOP NAV ===== */
    .topnav{
      background:#fff; border:1px solid #e6e6e6; border-radius:12px;
      padding:12px 16px; margin-bottom:14px; box-shadow:0 1px 2px rgba(0,0,0,.04);
      display:flex; justify-content:space-between; align-items:center; flex-wrap:wrap; gap:12px;
    }
    .brand{ font-weight:bold; font-size:16px; text-decoration:none; color:#111; }
    .nav-links{ display:flex; gap:10px; flex-wrap:wrap; }
    .btn{
      display:inline-block; padding:8px 12px; border:1px solid #ddd; border-radius:10px;
      text-decoration:none; color:#111; background:#fff; font-size:13px; cursor:pointer;
    }
    .btn:hover{ border-color:#cfcfcf; }
    .pill{ padding:8px 12px; border:1px solid #ddd; border-radius:999px; background:#fff; font-size:13px; color:#444; }

    /* ===== HEADER ===== */
    .header{
      background:#fff; border:1px solid #e6e6e6; border-radius:12px;
      padding:16px; margin-bottom:14px; box-shadow:0 1px 2px rgba(0,0,0,.04);
      display:flex; align-items:center; justify-content:space-between; gap:12px; flex-wrap:wrap;
    }
    .header h1{ margin:0; font-size:20px; }
    .sub{ color:#666; margin-top:4px; font-size:13px; }

    .box{
      background:#fff; border:1px solid #e6e6e6; border-radius:12px;
      padding:16px; box-shadow:0 1px 2px rgba(0,0,0,.04);
    }

    /* ===== ADD FORM ===== */
    .formrow{ display:flex; gap:10px; flex-wrap:wrap; align-items:center; margin-bottom:12px; }
    input[type="text"]{
      flex:1; min-width:240px; padding:10px 12px; border:1px solid #ddd; border-radius:10px; font-size:14px;
    }
    .hint{ color:#777; font-size:12px; margin-top:8px; }

    /* ===== TASK LIST ===== */
    .task{
      border:1px solid #eee; border-radius:12px; padding:12px; margin-bottom:10px;
      display:flex; justify-content:space-between; gap:12px; align-items:flex-start; background:#fff;
    }
    .task:last-child{ margin-bottom:0; }
    .task-title{ font-weight:bold; margin-bottom:6px; }
    .task-meta{ color:#777; font-size:12px; }
    .done{ opacity:.55; text-decoration:line-through; }

    .actions{ display:flex; gap:8px; flex-wrap:wrap; align-items:center; }
    .btn-danger{ border-color:#f0c1c1; }
    .btn-danger:hover{ border-color:#e59d9d; }

    .empty{ color:#666; font-size:14px; padding:10px 0; }
  </style>
</head>

<body>
  <div class="wrap">

    <!-- ===== TOP NAV ===== -->
    <div class="topnav">
      <a class="brand" href="/">Bobbies Portal</a>

      <div class="nav-links">
        <a class="btn" href="/">Home</a>
        <a class="btn" href="/live-board/">Team</a>
        <a class="btn" href="/bulletin/">Bulletin</a>
      </div>

      <div>
        {% if user.is_authenticated %}
          <span class="pill">Logged in: <b>{{ user.username }}</b></span>
          <a class="btn" href="/admin/logout/?next=/">Logout</a>
        {% else %}
          <a class="btn" href="/admin/login/?next=/">Login</a>
        {% endif %}
      </div>
    </div>

    <!-- ===== HEADER ===== -->
    <div class="header">
      <div>
        <h1>Managers Bulletin</h1>
        <div class="sub">If itâ€™s on the board, itâ€™s not done.</div>
      </div>
      <div>
        {% if can_edit %}
          <span class="pill">Editor Access âœ…</span>
        {% else %}
          <span class="pill">View Only</span>
        {% endif %}
      </div>
    </div>

    <div class="box">

      {% if can_edit %}
        <!-- ===== ADD NEW TASK ===== -->
        <form method="post" action="/bulletin/add/">
          {% csrf_token %}
          <div class="formrow">
            <input type="text" name="title" placeholder="Add a task (e.g. Book bus, buy ice, confirm ref)" required>
            <button class="btn" type="submit">Add</button>
          </div>
          <div class="hint">Tip: keep it short and specific. When itâ€™s done, mark it done.</div>
        </form>

        <hr style="border:none;border-top:1px solid #eee;margin:14px 0;">
      {% endif %}

      <!-- ===== LIST ===== -->
      {% if items %}
        {% for item in items %}
          <div class="task">
            <div>
              <div class="task-title {% if item.is_done %}done{% endif %}">
                {{ item.text }}
              </div>
              <div class="task-meta">
                {% if item.created_at %}Created: {{ item.created_at }}{% endif %}
                {% if item.is_done %} â€¢ Status: Done{% endif %}
              </div>
            </div>

            <div class="actions">
              {% if can_edit %}
                {% if not item.is_done %}
                  <form method="post" action="/bulletin/done/{{ item.id }}/" style="margin:0;">
                    {% csrf_token %}
                    <button class="btn" type="submit">Done</button>
                  </form>
                {% endif %}

                <form method="post" action="/bulletin/delete/{{ item.id }}/" style="margin:0;">
                  {% csrf_token %}
                  <button class="btn btn-danger" type="submit" onclick="return confirm('Delete this item?');">Delete</button>
                </form>
              {% endif %}
            </div>
          </div>
        {% endfor %}
      {% else %}
        <div class="empty">No items yet. (Thatâ€™s a good sign ðŸ˜„)</div>
      {% endif %}

    </div>

  </div>
</body>
</html>
